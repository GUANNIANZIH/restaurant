import{_ as I,a0 as B,r as A,c as N,o as i,b as O,w as c,d as r,e as P,W as u,f as d,g as b,F as S,V as g,X as h,a6 as $,Y as p,Z as q,$ as F}from"./index-BZb0P4mw.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{V as L,a as x}from"./VCol-D237f-9y.js";import{V as T}from"./VDivider-DOF0eTCc.js";import{V as E}from"./VDataTable-DYL7hkLM.js";import{V as R}from"./VRow-BvwjZx1h.js";import"./VPagination-ksiWmNuf.js";import"./VSelect-CxbWmTrQ.js";import"./VList-BnwRE_W3.js";import"./ssrBoot-ywDcbqE8.js";import"./VSlideGroup-DJaF-XCM.js";const W=l=>(q("data-v-c080f8df"),l=l(),F(),l),X=W(()=>u("h1",{class:"text-center text-cus"},"預購私廚訂單管理",-1)),v={__name:"ordersSpecialty",setup(l){const{apiAuth:m}=$(),n=B(),f=A([]),w=[{title:"訂單編號",key:"_id"},{title:"會員帳號",key:"user.account"},{title:"下單日期",key:"createdAt",value:t=>new Date(t.createdAt).toLocaleString()},{title:"訂單商品",key:"cartSpecialties",sortable:!1},{title:"訂單金額",key:"price",value:t=>t.cartSpecialties.reduce((s,e)=>s+e.quantity*e.p_id.price,0)},{title:"訂單狀態",key:"status",sortable:!1}],_=async()=>{var t,s;try{const{data:e}=await m.get("/order/allSpecialty");f.value.push(...e.result)}catch(e){console.log(e),n({text:((s=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}};_();const k=async(t,s)=>{var e,a;try{const{data:o}=await m.patch("/order/allSpecialty",{_id:t._id,status:s});n({text:o.message,snackbarProps:{color:"#3C5D44"}}),_()}catch(o){console.log(o),n({text:((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)||"發生錯誤",snackbarProps:{color:"red"}})}},C=async t=>{await k(t,"canceled")},y=t=>["completed","canceled"].includes(t),D=N(()=>f.value.slice().sort((t,s)=>{const e=["in-process","completed","canceled","canceled"];return e.indexOf(t.status)-e.indexOf(s.status)}));return(t,s)=>(i(),O(L,null,{default:c(()=>[r(R,null,{default:c(()=>[r(x,{cols:"12"},{default:c(()=>[X]),_:1}),r(T),r(x,{cols:"12"},{default:c(()=>[r(E,{items:P(D),headers:w},{"item.cartSpecialties":c(e=>[u("ul",null,[(i(!0),d(S,null,b(e.item.cartSpecialties,a=>(i(),d("li",{key:a._id},p(a.p_id.name)+" * "+p(a.quantity),1))),128))])]),"item.status":c(({item:e})=>[u("div",null,[(i(),d(S,null,b(["in-processing","completed"],a=>r(g,{key:a,onClick:o=>k(e,a),class:"mt-2 mb-2 w-75 bg-dark",disabled:y(e.status)},{default:c(()=>[h(p(a),1)]),_:2},1032,["onClick","disabled"])),64)),r(g,{title:"canceled",onClick:a=>C(e),class:"mt-2 mb-2 w-75 bg-er",disabled:y(e.status)},{default:c(()=>[h("Canceled")]),_:2},1032,["onClick","disabled"])])]),_:2},1032,["items"])]),_:1})]),_:1})]),_:1}))}};typeof V=="function"&&V(v);const ee=I(v,[["__scopeId","data-v-c080f8df"]]);export{ee as default};
