import{aR as H,a1 as q,r as p,a as J,o as B,b as R,w as n,d as a,aQ as Q,e as r,aM as X,aJ as Y,X as _,Y as Z,a4 as h,aK as T,a5 as G,V as F,a6 as ee,a7 as L,aP as ae,at as le,J as te,aa as oe,_ as ve,f as fe,F as Ve,Z as be,$ as ye,W as K}from"./index-Bmq1rx2x.js";import{c as se,a as I,e as re,b as ne,u as ue,d as C,V as ie}from"./vee-validate.esm-CjwpAkX3.js";import{V as de}from"./VSelect-DXS6PnyO.js";import{V as pe}from"./VCheckbox-DSi8lP8s.js";import{V as me}from"./VTextarea-CJnJ2flW.js";import{V as ce}from"./VDataTableServer-CQvU54Lv.js";import{b as E}from"./route-block-B_A1xBdJ.js";import{V as ke,a as N}from"./VCol-B1ZB-sXA.js";import{V as xe}from"./VRow-BnKSKRpE.js";import{a as De}from"./VToolbar-BLQyC3ct.js";import{V as Se,a as W,b as we,c as j}from"./VTabs-edXYhS96.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VList-DSwuW50X.js";import"./ssrBoot-D6JNUIId.js";import"./VDivider-C1bxpiy7.js";import"./VSlideGroup-Dx3HcNRG.js";import"./VDataTable-EP9WZV0l.js";import"./VPagination-JoWcbP0K.js";import"./VWindowItem-d5MoNR4-.js";function Me(V){return{all:V=V||new Map,on:function(g,o){var m=V.get(g);m?m.push(o):V.set(g,[o])},off:function(g,o){var m=V.get(g);m&&(o?m.splice(m.indexOf(o)>>>0,1):V.set(g,[]))},emit:function(g,o){var m=V.get(g);m&&m.slice().map(function(S){S(o)}),(m=V.get("*"))&&m.slice().map(function(S){S(g,o)})}}}const O=Me(),Pe={__name:"menuProductDialog",setup(V,{expose:g}){const o=H({open:!1,id:"",name:"",price:"",description:"",category:"",sell:!1}),{apiAuth:m}=L(),S=q(),M=p(null),k=["炒飯 | Fried Rice","炒麵 | Fried Noodles","湯麵 | Soup Noodles","炒米粉 | Fried Vermicelli","湯米粉 | Soup Vermicelli","湯品 | Soup","小品 | Dishes","新品上市"],c=se({name:I().required("餐點名稱必填"),price:re().typeError("餐點價格格式錯誤").required("餐點價格必填").min(0,"商品價格不能小於 0"),description:I().required("餐點說明項目必填"),category:I().required("餐點分類必填").test("isCategory","餐點分類錯誤",t=>k.includes(t)),sell:ne()}),{handleSubmit:b,isSubmitting:w,resetForm:A}=ue({validationSchema:c,initialValues:{name:"",price:0,description:"",category:"",sell:!0}}),x=C("name"),D=C("price"),v=C("description"),d=C("category"),f=C("sell"),e=p([]),l=p([]),P=t=>{console.log(t),o.open=!0},U=()=>{o.open=!1,A(),M.value.deleteFileRecord()},y=b(async t=>{var s,$,u;if(!((s=e.value[0])!=null&&s.error)&&!(o.id.length===0&&e.value.length<1))try{const i=new FormData;i.append("name",t.name),i.append("price",t.price),i.append("description",t.description),i.append("category",t.category),i.append("sell",t.sell),e.value.length>0&&i.append("image",e.value[0].file),o.id===""?await m.post("/product",i):await m.patch("/product/"+o.id,i),S({text:o.id===""?"新增成功":"編輯成功",snackbarProps:{color:"#D78A24"}}),U()}catch(i){console.log(i),S({text:((u=($=i==null?void 0:i.response)==null?void 0:$.data)==null?void 0:u.message)||"發生錯誤",snackbarProps:{color:"#D66425"}})}});return O.on("openMenuDialog",t=>{t!=null&&(console.log("on",t),o.id=t._id,x.value.value=t.name,D.value.value=t.price,v.value.value=t.description,d.value.value=t.category,f.value.value=t.sell),o.open=!0}),g({dialog:o,open:P}),(t,s)=>{const $=J("vue-file-agent");return B(),R(ee,{modelValue:o.open,"onUpdate:modelValue":s[7]||(s[7]=u=>o.open=u),persistent:"",width:"500"},{default:n(()=>[a(ie,{onSubmit:Q(r(y),["prevent"]),disabled:r(w)},{default:n(()=>[a(X,null,{default:n(()=>[a(Y,null,{default:n(()=>[_(Z(o.id?"編輯商品":"新增商品"),1)]),_:1}),a(h,null,{default:n(()=>[a(T,{label:"名稱",modelValue:r(x).value.value,"onUpdate:modelValue":s[0]||(s[0]=u=>r(x).value.value=u),"error-messages":r(x).errorMessage.value},null,8,["modelValue","error-messages"]),a(T,{label:"價格",type:"number",min:"0",modelValue:r(D).value.value,"onUpdate:modelValue":s[1]||(s[1]=u=>r(D).value.value=u),"error-messages":r(D).errorMessage.value},null,8,["modelValue","error-messages"]),a(de,{label:"分類",items:k,modelValue:r(d).value.value,"onUpdate:modelValue":s[2]||(s[2]=u=>r(d).value.value=u),"error-messages":r(d).errorMessage.value},null,8,["modelValue","error-messages"]),a(pe,{label:"產品上市",modelValue:r(f).value.value,"onUpdate:modelValue":s[3]||(s[3]=u=>r(f).value.value=u),"error-messages":r(f).errorMessage.value},null,8,["modelValue","error-messages"]),a(me,{label:"餐點描述",modelValue:r(v).value.value,"onUpdate:modelValue":s[4]||(s[4]=u=>r(v).value.value=u),"error-messages":r(v).errorMessage.value},null,8,["modelValue","error-messages"]),a($,{modelValue:e.value,"onUpdate:modelValue":s[5]||(s[5]=u=>e.value=u),"raw-model-value":l.value,"onUpdate:rawModelValue":s[6]||(s[6]=u=>l.value=u),accept:"image/jpeg,image/png",deletable:"","max-size":"5MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 5MB"},ref_key:"fileAgent",ref:M},null,8,["modelValue","raw-model-value"])]),_:1}),a(G,null,{default:n(()=>[a(F,{color:"red",loading:r(w),onClick:U},{default:n(()=>[_("取消")]),_:1},8,["loading"]),a(F,{color:"green",type:"submit",loading:r(w)},{default:n(()=>[_("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1},8,["modelValue"])}}},Ue={__name:"specialtyProductDialog",setup(V,{expose:g}){const o=H({open:!1,id:"",name:"",price:"",description:"",category:"",sell:!1}),{apiAuth:m}=L(),S=q(),M=p(null),k=["料理包預購 | MealKit Pre-order","私廚預購 | Chef Pre-order"],c=se({name:I().required("餐點名稱必填"),price:re().typeError("餐點價格格式錯誤").required("餐點價格必填").min(0,"商品價格不能小於 0"),description:I().required("餐點說明項目必填"),category:I().required("餐點分類必填").test("isCategory","餐點分類錯誤",t=>k.includes(t)),sell:ne()}),{handleSubmit:b,isSubmitting:w,resetForm:A}=ue({validationSchema:c,initialValues:{name:"",price:0,description:"",category:"",sell:!0}}),x=C("name"),D=C("price"),v=C("description"),d=C("category"),f=C("sell"),e=p([]),l=p([]),P=t=>{o.open=!0,t&&(o.id=t.id,x.value=t.name,D.value=t.price,v.value=t.description,d.value=t.category,f.value=t.sell)},U=()=>{o.open=!1,A(),M.value.deleteFileRecord()},y=b(async t=>{var s,$,u;if(!((s=e.value[0])!=null&&s.error)&&!(o.id.length===0&&e.value.length<1))try{const i=new FormData;i.append("name",t.name),i.append("price",t.price),i.append("description",t.description),i.append("category",t.category),i.append("sell",t.sell),e.value.length>0&&i.append("image",e.value[0].file),o.id===""?await m.post("/specialty",i):await m.patch("/specialty/"+o.id,i),S({text:o.id===""?"新增成功":"編輯成功",snackbarProps:{color:"#D78A24"}}),U()}catch(i){console.log(i),S({text:((u=($=i==null?void 0:i.response)==null?void 0:$.data)==null?void 0:u.message)||"發生錯誤",snackbarProps:{color:"#D66425"}})}});return O.on("openSpecialtyDialog",t=>{t!=null&&(console.log("on",t),o.id=t._id,x.value.value=t.name,D.value.value=t.price,v.value.value=t.description,d.value.value=t.category,f.value.value=t.sell),o.open=!0}),g({open:P}),(t,s)=>{const $=J("vue-file-agent");return B(),R(ee,{modelValue:o.open,"onUpdate:modelValue":s[7]||(s[7]=u=>o.open=u),persistent:"",width:"500"},{default:n(()=>[a(ie,{onSubmit:Q(r(y),["prevent"]),disabled:r(w)},{default:n(()=>[a(X,null,{default:n(()=>[a(Y,null,{default:n(()=>[_(Z(o.id?"編輯商品":"新增商品"),1)]),_:1}),a(h,null,{default:n(()=>[a(T,{label:"名稱",modelValue:r(x).value.value,"onUpdate:modelValue":s[0]||(s[0]=u=>r(x).value.value=u),"error-messages":r(x).errorMessage.value},null,8,["modelValue","error-messages"]),a(T,{label:"價格",type:"number",min:"0",modelValue:r(D).value.value,"onUpdate:modelValue":s[1]||(s[1]=u=>r(D).value.value=u),"error-messages":r(D).errorMessage.value},null,8,["modelValue","error-messages"]),a(de,{label:"分類",items:k,modelValue:r(d).value.value,"onUpdate:modelValue":s[2]||(s[2]=u=>r(d).value.value=u),"error-messages":r(d).errorMessage.value},null,8,["modelValue","error-messages"]),a(pe,{label:"產品上市",modelValue:r(f).value.value,"onUpdate:modelValue":s[3]||(s[3]=u=>r(f).value.value=u),"error-messages":r(f).errorMessage.value},null,8,["modelValue","error-messages"]),a(me,{label:"餐點描述",modelValue:r(v).value.value,"onUpdate:modelValue":s[4]||(s[4]=u=>r(v).value.value=u),"error-messages":r(v).errorMessage.value},null,8,["modelValue","error-messages"]),a($,{modelValue:e.value,"onUpdate:modelValue":s[5]||(s[5]=u=>e.value=u),"raw-model-value":l.value,"onUpdate:rawModelValue":s[6]||(s[6]=u=>l.value=u),accept:"image/jpeg,image/png",deletable:"","max-size":"5MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 5MB"},ref_key:"fileAgent",ref:M},null,8,["modelValue","raw-model-value"])]),_:1}),a(G,null,{default:n(()=>[a(F,{color:"red",loading:r(w),onClick:U},{default:n(()=>[_("取消")]),_:1},8,["loading"]),a(F,{color:"green",type:"submit",loading:r(w)},{default:n(()=>[_("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1},8,["modelValue"])}}},Ce={__name:"menuProducts_dataTable",props:{onOpenMenuDialog:Function},setup(V,{expose:g}){const{apiAuth:o}=L(),m=q();p(1);const S=V,M=f=>{console.log("emit"),O.emit("openMenuDialog",f),S.onOpenMenuDialog},k=p(6),c=p([{key:"price",order:"desc"}]),b=p(1),w=p([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!0,key:"name"},{title:"價格",align:"center",sortable:!0,key:"price"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"上架",align:"center",sortable:!0,key:"sell"},{title:"操作",align:"center",sortable:!1,key:"action"}],x=p(!0),D=p(0),v=p(""),d=async f=>{var e,l,P,U;f&&(b.value=1),x.value=!0;try{const{data:y}=await o.get("/product/all",{params:{page:b.value,itemsPerPage:k.value,sortBy:((e=c.value[0])==null?void 0:e.key)||"price",sortOrder:((l=c.value[0])==null?void 0:l.order)||"desc",search:v.value}});w.value.splice(0,w.value.length,...y.result.data),D.value=y.result.total}catch(y){console.log(y),m({text:((U=(P=y==null?void 0:y.response)==null?void 0:P.data)==null?void 0:U.message)||"發生錯誤",snackbarProps:{color:"red"}})}x.value=!1};return d(),g({tableLoadItems:d}),(f,e)=>(B(),R(ce,{"items-per-page":k.value,"onUpdate:itemsPerPage":[e[3]||(e[3]=l=>k.value=l),e[6]||(e[6]=l=>d(!1))],"sort-by":c.value,"onUpdate:sortBy":[e[4]||(e[4]=l=>c.value=l),e[7]||(e[7]=l=>d(!1))],page:b.value,"onUpdate:page":[e[5]||(e[5]=l=>b.value=l),e[8]||(e[8]=l=>d(!1))],items:w.value,headers:A,loading:x.value,"items-length":D.value,search:v.value,hover:""},{top:n(()=>[a(T,{label:"搜尋",modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=l=>v.value=l),"append-icon":"mdi-magnify",onClickAppend:e[1]||(e[1]=l=>d(!0)),onKeydown:e[2]||(e[2]=ae(l=>d(!0),["enter"]))},null,8,["modelValue"])]),"item.image":n(({value:l})=>[a(le,{src:l,height:"50px"},null,8,["src"])]),"item.sell":n(({value:l})=>[l?(B(),R(te,{key:0,icon:"mdi-check"})):oe("",!0)]),"item.action":n(({item:l})=>[a(F,{icon:"mdi-pencil",variant:"text",color:"#D78A24",onClick:P=>M(l)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]))}},$e={__name:"specialtyProducts_dataTable",props:{onOpenSpecialtyDialog:Function},setup(V,{expose:g}){const{apiAuth:o}=L(),m=q();p(1);const S=V,M=f=>{console.log("emit"),O.emit("openSpecialtyDialog",f),S.onOpenSpecialtyDialog},k=p(10),c=p([{key:"price",order:"desc"}]),b=p(1),w=p([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!0,key:"name"},{title:"價格",align:"center",sortable:!0,key:"price"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"上架",align:"center",sortable:!0,key:"sell"},{title:"操作",align:"center",sortable:!1,key:"action"}],x=p(!0),D=p(0),v=p(""),d=async f=>{var e,l,P,U;f&&(b.value=1),x.value=!0;try{const{data:y}=await o.get("/specialty/all",{params:{page:b.value,itemsPerPage:k.value,sortBy:((e=c.value[0])==null?void 0:e.key)||"price",sortOrder:((l=c.value[0])==null?void 0:l.order)||"desc",search:v.value}});w.value.splice(0,w.value.length,...y.result.data),D.value=y.result.total}catch(y){console.log(y),m({text:((U=(P=y==null?void 0:y.response)==null?void 0:P.data)==null?void 0:U.message)||"發生錯誤",snackbarProps:{color:"red"}})}x.value=!1};return d(),g({tableLoadItems:d}),(f,e)=>(B(),R(ce,{"items-per-page":k.value,"onUpdate:itemsPerPage":[e[3]||(e[3]=l=>k.value=l),e[6]||(e[6]=l=>d(!1))],"sort-by":c.value,"onUpdate:sortBy":[e[4]||(e[4]=l=>c.value=l),e[7]||(e[7]=l=>d(!1))],page:b.value,"onUpdate:page":[e[5]||(e[5]=l=>b.value=l),e[8]||(e[8]=l=>d(!1))],items:w.value,headers:A,loading:x.value,"items-length":D.value,search:v.value,hover:""},{top:n(()=>[a(T,{label:"搜尋",modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=l=>v.value=l),"append-icon":"mdi-magnify",onClickAppend:e[1]||(e[1]=l=>d(!0)),onKeydown:e[2]||(e[2]=ae(l=>d(!0),["enter"]))},null,8,["modelValue"])]),"item.image":n(({value:l})=>[a(le,{src:l,height:"50px"},null,8,["src"])]),"item.sell":n(({value:l})=>[l?(B(),R(te,{key:0,icon:"mdi-check"})):oe("",!0)]),"item.action":n(({item:l})=>[a(F,{icon:"mdi-pencil",variant:"text",color:"#D78A24",onClick:P=>M(l)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]))}},z=V=>(be("data-v-368196ec"),V=V(),ye(),V),_e=z(()=>K("h1",{class:"text-center text-cus"},"餐點 & 私廚上下架管理",-1)),Fe=z(()=>K("p",{class:"text-h6"},"Menu Management | 菜單管理",-1)),Ae=z(()=>K("p",{class:"text-h6"},"Specialty Management | 私廚料理管理",-1)),ge={__name:"products",setup(V){const g=p(1),o=p(null),m=p(null),S=k=>{O.emit("openMenuDialog",k)},M=k=>{O.emit("openSpecialtyDialog",k)};return(k,c)=>(B(),fe(Ve,null,[a(ke,null,{default:n(()=>[a(xe,null,{default:n(()=>[a(N,{cols:"12"},{default:n(()=>[_e]),_:1}),a(N,{cols:"12"},{default:n(()=>[a(F,{color:"#3C5D44",class:"me-4",onClick:c[0]||(c[0]=b=>S(null))},{default:n(()=>[_("菜單管理")]),_:1}),a(F,{color:"#3C5D44",onClick:c[1]||(c[1]=b=>M(null))},{default:n(()=>[_("私廚料理管理")]),_:1})]),_:1}),a(N,{cols:"12"},{default:n(()=>[a(De,{color:"surface"},{extension:n(()=>[a(Se,{modelValue:g.value,"onUpdate:modelValue":c[2]||(c[2]=b=>g.value=b),grow:""},{default:n(()=>[a(W,{value:1},{default:n(()=>[Fe]),_:1}),a(W,{value:2},{default:n(()=>[Ae]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(we,{modelValue:g.value,"onUpdate:modelValue":c[3]||(c[3]=b=>g.value=b)},{default:n(()=>[a(j,{value:1,class:"h-75"},{default:n(()=>[a(Ce,{class:"h-75"})]),_:1}),a(j,{value:2,class:"h-75"},{default:n(()=>[a($e,{class:"h-75"})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(Pe,{ref_key:"menuDialogRef",ref:o},null,512),a(Ue,{ref_key:"specialtyDialogRef",ref:m},null,512)],64))}};typeof E=="function"&&E(ge);const he=ve(ge,[["__scopeId","data-v-368196ec"]]);export{he as default};
